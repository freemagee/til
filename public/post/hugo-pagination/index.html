<!doctype html><html class=no-js lang=en-gb><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><title>TIL - Hugo theme improved pagination</title><meta name=description content="How to do pagination in your Hugo theme"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content="Neil Magee"><meta name=referrer content=no-referrer-when-downgrade><link href=/images/favicon/favicon-16x16.png rel="shortcut icon" type=image/png><link rel=stylesheet href=/css/style-b662c601.css><link rel=stylesheet href=/css/code-highlighting-52395fdb.css></head><body><header class=site-header><section class=site-header__ident><a href=https://til.neilmagee.com/ class=site-header__link>TIL</a></section><nav class=site-header__nav><a href=/about class=site-header__nav-item>About</a></nav></header><div class=site-container><div class=site-container__inner><main role=main id=content><article class="post post--single" itemscope itemtype=http://schema.org/BlogPosting><header class=post__header><h1 class="post__title post__title--single" itemprop=title>Hugo theme improved pagination</h1><div class=post__meta><time class=post__date datetime=2019-07-18 itemprop="dateCreated pubdate datePublished"><span class=post__date-icon><svg id="Calendar" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 20 20" enable-background="new 0 0 20 20"><path d="M17 3h-1v2h-3V3H7v2H4V3H3C1.899 3 1 3.9 1 5v12c0 1.1.899 2 2 2h14c1.1.0 2-.9 2-2V5C19 3.9 18.1 3 17 3zm0 14H3V9h14v8zM6.5 1h-2v3.5h2V1zm9 0h-2v3.5h2V1z" class="post__meta-icon" /></svg></span><span class=post__date-label>2019-07-18</span></time><div class=post__read-time><span class=post__read-time-icon><svg id="Stopwatch" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 20 20" enable-background="new 0 0 20 20"><path d="M7.376 6.745c-.447.275 1.197 4.242 1.598 4.888.35.569 1.093.742 1.658.394.568-.352.745-1.094.395-1.66C10.63 9.719 7.822 6.469 7.376 6.745zM7.041 2.402C7.969 2.079 8.963 1.9 10 1.9s2.031.179 2.959.502c.329.114.765-.115.572-.611-.141-.36-.277-.712-.332-.855-.131-.339-.6-.619-.804-.665C11.623.097 10.823.0 10 0S8.377.097 7.604.271C7.4.317 6.932.597 6.801.936 6.746 1.079 6.609 1.431 6.469 1.791 6.276 2.287 6.712 2.517 7.041 2.402zM19.098 3.186c-.192-.23-.396-.455-.613-.672-.216-.217-.441-.42-.67-.613-.153-.129-.603-.234-.888.051-.284.285-1.648 1.647-1.648 1.647.402.288.793.605 1.155.966.362.361.677.752.966 1.155.0.0 1.363-1.362 1.647-1.647C19.333 3.787 19.228 3.338 19.098 3.186zM10 2.9c-4.475.0-8.101 3.626-8.101 8.1.0 4.475 3.626 8.101 8.101 8.101 4.473.0 8.1-3.626 8.1-8.101C18.1 6.527 14.473 2.9 10 2.9zM10 17.101c-3.368.0-6.1-2.731-6.1-6.1.0-3.369 2.731-6.1 6.1-6.1 3.369.0 6.101 2.731 6.101 6.1C16.101 14.369 13.369 17.101 10 17.101z" class="post__meta-icon" /></svg></span><span class=post__read-time-label>6 min read</span></div><ul class=post__categories><li class=post__category><a href=/categories/development class=post__category-link>development</a></li></ul></div></header><section class=post-content><p>Today I learned how to do numbered pagination in my <a href=https://github.com/freemagee/comfortable-basic>Hugo theme</a> using <code>golang</code>. This was a bit harder than I expected as I am no expert on programming with <code>golang</code>. But once I remembered that <code>golang</code> still follows the same programming conventions that other languages do, even though the syntax is different.</p><p>After the posts in my theme, there is a simple navigation area at the bottom. At the moment it looks like this:</p><figure><img src=/images/improved-pagination/current-pagination.png alt="An image of my Hugo themes current pagination" loading=lazy><figcaption><h4>My current pagination</h4></figcaption></figure><p>It works fine, and let&rsquo;s you navigate through the posts linearly. But as this site gets more posts, I saw the need to be able to jump to a particular page. I looked for an existing theme that used pagination similarly to how I wanted. I found <a href=https://themes.gohugo.io/theme/hugo-bootstrap/>Hugo Bootstrap</a> and went to look at the <a href=https://github.com/Xzya/hugo-bootstrap/blob/master/layouts/partials/paginator.html>pagination source code</a>. It took me a while to decipher it as the syntax is so different to PHP or JavaScript that I am more familiar with.</p><h3 id=the-hugo-bootstrap-pagination-source>The Hugo Bootstrap pagination source</h3><pre><code class=language-golang>{{ $pag := $.Paginator }}
{{ if gt $pag.TotalPages 1 }}
&lt;nav class=&quot;blog-pagination&quot;&gt;
    &lt;ul class=&quot;pagination justify-content-center&quot;&gt;
        {{ with $pag.First }}
        &lt;li class=&quot;page-item&quot;&gt;
            &lt;a class=&quot;page-link&quot; href=&quot;{{ .URL }}&quot; aria-label=&quot;First&quot;&gt;&lt;span aria-hidden=&quot;true&quot;&gt;&amp;laquo;&amp;laquo;&lt;/span&gt;&lt;/a&gt;
        &lt;/li&gt;
        {{ end }}
        &lt;li class=&quot;page-item {{ if not $pag.HasPrev }}disabled{{ end }}&quot;&gt;
            &lt;a class=&quot;page-link&quot; href=&quot;{{ if $pag.HasPrev }}{{ $pag.Prev.URL }}{{ end }}&quot; aria-label=&quot;Previous&quot;&gt;&lt;span aria-hidden=&quot;true&quot;&gt;&amp;laquo;&lt;/span&gt;&lt;/a&gt;
        &lt;/li&gt;
        {{ $.Scratch.Set &quot;__paginator.ellipsed&quot; false }}
        {{ range $pag.Pagers }}
            {{ $right := sub .TotalPages .PageNumber }}
            {{ $showNumber := or (le .PageNumber 3) (eq $right 0) }}
            {{ $showNumber := or $showNumber (and (gt .PageNumber (sub $pag.PageNumber 2)) (lt .PageNumber (add $pag.PageNumber 2)))  }}
            {{ if $showNumber }}
                {{ $.Scratch.Set &quot;__paginator.ellipsed&quot; false }}
                {{ $.Scratch.Set &quot;__paginator.shouldEllipse&quot; false }}
            {{ else }}
                {{ $.Scratch.Set &quot;__paginator.shouldEllipse&quot; (not ($.Scratch.Get &quot;__paginator.ellipsed&quot;) ) }}
                {{ $.Scratch.Set &quot;__paginator.ellipsed&quot; true }}
            {{ end }}
            {{ if $showNumber }}
                &lt;li class=&quot;page-item {{ if eq . $pag }}active{{ end }}&quot;&gt;
                    &lt;a class=&quot;page-link&quot; href=&quot;{{ .URL }}&quot;&gt;{{ .PageNumber }}&lt;/a&gt;
                &lt;/li&gt;
            {{ else if ($.Scratch.Get &quot;__paginator.shouldEllipse&quot;) }}
                &lt;li class=&quot;page-item disabled&quot;&gt;
                    &lt;span class=&quot;page-link&quot; aria-hidden=&quot;true&quot;&gt;&amp;hellip;&lt;/span&gt;
                &lt;/li&gt;
            {{ end }}
        {{ end }}
        &lt;li class=&quot;page-item {{ if not $pag.HasNext }}disabled{{ end }}&quot;&gt;
            &lt;a class=&quot;page-link&quot; href=&quot;{{ if $pag.HasNext }}{{ $pag.Next.URL }}{{ end }}&quot; aria-label=&quot;Next&quot;&gt;&lt;span aria-hidden=&quot;true&quot;&gt;&amp;raquo;&lt;/span&gt;&lt;/a&gt;
        &lt;/li&gt;
        {{ with $pag.Last }}
            &lt;li class=&quot;page-item&quot;&gt;
                &lt;a class=&quot;page-link&quot; href=&quot;{{ .URL }}&quot; aria-label=&quot;Last&quot;&gt;&lt;span aria-hidden=&quot;true&quot;&gt;&amp;raquo;&amp;raquo;&lt;/span&gt;&lt;/a&gt;
            &lt;/li&gt;
        {{ end }}
    &lt;/ul&gt;
&lt;/nav&gt;
{{ end }}
</code></pre><p>This can be interpreted as:</p><pre><code>if there are more pages than 1
  show first page link
  show previous page link
  loop over pages
    show a numbered page link
  end loop
  show next page link
  show last page link
end if
</code></pre><p>There is more going on, but this was enough to get me started. First thing I did was pasted the Hugo Bootstrap code into my partial to see what would happen. This caused Hugo to fall over and display some errors. After looking at the Hugo Bootstrap implementation I could see I was using the pagination feature of Hugo differently. In the Hugo implementation, the partial is responsible for generating a list of pages for the pagination partial. That is what <code>{{ $pag := $.Paginator }}</code> does on the first line. In my Hugo theme, I pass in the list of pages into my partial from it&rsquo;s parent (index.html). That meant instead of doing <code>$pag.TotalPages</code> I could simply do <code>.TotalPages</code> with the full stop acting a bit like <code>this</code> in JavaScript.</p><p>After removing references to <code>$pag</code> that got the first, previous, next and last links working. The Hugo debugger was still complaining about <code>$.Scratch.Set</code>. After looking up <em>Scratch</em> in the Hugo docs I tried to set <code>Scratch</code> as a local variable <code>{{ $scratch := newScratch }}</code>. Then I changed all references to <code>$.Scratch</code> to use <code>$scratch</code> instead. <strong>Bingo</strong>. The pagination rendered. I swapped the Hugo Bootstrap elements for my own and made some new CSS classes to style the new elements. That left my pagination looking like this:</p><figure><img src=/images/improved-pagination/pagination-working.png alt="An image of my Hugo themes new pagination" loading=lazy><figcaption><h4>The new pagination</h4></figcaption></figure><p>The final part for me to get working was setting the current page number as active in the pagination. I could see how it worked in the Hugo Bootstrap theme, they compared the <em>current page</em> against the <em>current item</em> in the <code>$pag.Pager</code> loop - <code>{{ if eq . $pag }}</code>. But because my theme is a little different, I could not initially get the current page number. I thought this might work for a second <code>{{ if eq . .PageNumber }}</code>. It didn&rsquo;t. It took a little while to understand how to get to the parent page variable. That&rsquo;s where I had a little <em>eureka</em> moment and set <code>{{ $thisPageNumber := .PageNumber }}</code> at the top of my pagination partial and then referenced it below <code>{{ if eq .PageNumber $thisPageNumber }}</code>. <em>Voila</em>, the active links now worked:</p><figure><img src=/images/improved-pagination/active-page-working.png alt="An image of active page highlighted in the pagination" loading=lazy><figcaption><h4>Active links working</h4></figcaption></figure><p>Now all the elements I need are in place, I can refine the design more. The pagination is obviously too wide at the moment and I have not seen the <em>ellipsis</em> feature in action yet. So there may be a post to come about that.</p><h3 id=my-wip-pagination-code>My WIP pagination code</h3><pre><code class=language-golang>{{ $thisPageNumber := .PageNumber }}
{{ if ne .TotalPages 0}}
&lt;nav class=&quot;pagination&quot;&gt;
  &lt;div class=&quot;pagination__ctrl&quot;&gt;
    {{ with .First }}
    &lt;a href=&quot;{{ .URL }}&quot; class=&quot;pagination__nav pagination__nav--newer&quot;&gt;&lt;span class=&quot;pagination__nav-icon&quot;&gt;
      &lt;svg version=&quot;1.1&quot; id=&quot;Chevron_left&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot; x=&quot;0px&quot;
      y=&quot;0px&quot; viewBox=&quot;0 0 20 20&quot; enable-background=&quot;new 0 0 20 20&quot; xml:space=&quot;preserve&quot;&gt;
      &lt;path d=&quot;M12.452,4.516c0.446,0.436,0.481,1.043,0,1.576L8.705,10l3.747,3.908c0.481,0.533,0.446,1.141,0,1.574
      c-0.445,0.436-1.197,0.408-1.615,0c-0.418-0.406-4.502-4.695-4.502-4.695C6.112,10.57,6,10.285,6,10s0.112-0.57,0.335-0.789
      c0,0,4.084-4.287,4.502-4.695C11.255,4.107,12.007,4.08,12.452,4.516z&quot; class=&quot;pagination__nav-icon-newer&quot; /&gt;
      &lt;/svg&gt;
    &lt;/span&gt;First page&lt;/a&gt;
    {{ end }}

    &lt;a href=&quot;{{ if .HasPrev }}{{ .Prev.URL }}{{ end }}&quot; class=&quot;pagination__nav pagination__nav--newer {{ if not .HasPrev }}pagination__nav--disabled{{ end }}&quot;&gt;&lt;span class=&quot;pagination__nav-icon&quot;&gt;
      &lt;svg version=&quot;1.1&quot; id=&quot;Chevron_left&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot; x=&quot;0px&quot;
      y=&quot;0px&quot; viewBox=&quot;0 0 20 20&quot; enable-background=&quot;new 0 0 20 20&quot; xml:space=&quot;preserve&quot;&gt;
      &lt;path d=&quot;M12.452,4.516c0.446,0.436,0.481,1.043,0,1.576L8.705,10l3.747,3.908c0.481,0.533,0.446,1.141,0,1.574
      c-0.445,0.436-1.197,0.408-1.615,0c-0.418-0.406-4.502-4.695-4.502-4.695C6.112,10.57,6,10.285,6,10s0.112-0.57,0.335-0.789
      c0,0,4.084-4.287,4.502-4.695C11.255,4.107,12.007,4.08,12.452,4.516z&quot; class=&quot;pagination__nav-icon-newer&quot; /&gt;
      &lt;/svg&gt;
    &lt;/span&gt;Newer posts&lt;/a&gt;

    {{ $scratch := newScratch }}
    {{ $scratch.Set &quot;.ellipsed&quot; false }}
    {{ range .Pagers }}

    {{ $right := sub .TotalPages .PageNumber }}
    {{ $showNumber := or (le .PageNumber 3) (eq $right 0) }}
    {{ $showNumber := or $showNumber (and (gt .PageNumber (sub .PageNumber 2)) (lt .PageNumber (add .PageNumber 2))) }}

    {{ if $showNumber }}
      {{ $scratch.Set &quot;__paginator.ellipsed&quot; false }}
      {{ $scratch.Set &quot;__paginator.shouldEllipse&quot; false }}
    {{ else }}
      {{ $scratch.Set &quot;__paginator.shouldEllipse&quot; (not ($scratch.Get &quot;__paginator.ellipsed&quot;) ) }}
      {{ $scratch.Set &quot;__paginator.ellipsed&quot; true }}
    {{ end }}

    {{ if $showNumber }}
    &lt;a class=&quot;pagination__nav {{ if eq .PageNumber $thisPageNumber }}pagination__nav--active{{ end }}&quot; href=&quot;{{ .URL }}&quot;&gt;{{ .PageNumber }}&lt;/a&gt;
    {{ else if ($scratch.Get &quot;__paginator.shouldEllipse&quot;) }}
    &lt;span class=&quot;pagination__nav pagination__nav--disabled&quot; aria-hidden=&quot;true&quot;&gt;&amp;hellip;&lt;/span&gt;
    {{ end }}

    {{ end }}

    &lt;a href=&quot;{{ if .HasNext }}{{ .Next.URL }}{{ end }}&quot; class=&quot;pagination__nav pagination__nav--older {{ if not .HasNext }}pagination__nav--disabled{{ end }}&quot;&gt;Older posts&lt;span class=&quot;pagination__nav-icon&quot;&gt;
      &lt;svg version=&quot;1.1&quot; id=&quot;Chevron_right&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot; x=&quot;0px&quot;
      y=&quot;0px&quot; viewBox=&quot;0 0 20 20&quot; enable-background=&quot;new 0 0 20 20&quot; xml:space=&quot;preserve&quot;&gt;
      &lt;path d=&quot;M9.163,4.516c0.418,0.408,4.502,4.695,4.502,4.695C13.888,9.43,14,9.715,14,10s-0.112,0.57-0.335,0.787
      c0,0-4.084,4.289-4.502,4.695c-0.418,0.408-1.17,0.436-1.615,0c-0.446-0.434-0.481-1.041,0-1.574L11.295,10L7.548,6.092
      c-0.481-0.533-0.446-1.141,0-1.576C7.993,4.08,8.745,4.107,9.163,4.516z&quot; class=&quot;pagination__nav-icon-previous&quot; /&gt;
      &lt;/svg&gt;
    &lt;/span&gt;&lt;/a&gt;

    {{ with .Last }}
    &lt;a href=&quot;{{ .URL }}&quot; class=&quot;pagination__nav pagination__nav--older&quot;&gt;Last page&lt;span class=&quot;pagination__nav-icon&quot;&gt;
      &lt;svg version=&quot;1.1&quot; id=&quot;Chevron_right&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot; x=&quot;0px&quot;
      y=&quot;0px&quot; viewBox=&quot;0 0 20 20&quot; enable-background=&quot;new 0 0 20 20&quot; xml:space=&quot;preserve&quot;&gt;
      &lt;path d=&quot;M9.163,4.516c0.418,0.408,4.502,4.695,4.502,4.695C13.888,9.43,14,9.715,14,10s-0.112,0.57-0.335,0.787
      c0,0-4.084,4.289-4.502,4.695c-0.418,0.408-1.17,0.436-1.615,0c-0.446-0.434-0.481-1.041,0-1.574L11.295,10L7.548,6.092
      c-0.481-0.533-0.446-1.141,0-1.576C7.993,4.08,8.745,4.107,9.163,4.516z&quot; class=&quot;pagination__nav-icon-previous&quot; /&gt;
      &lt;/svg&gt;
    &lt;/span&gt;&lt;/a&gt;
    {{ end }}
  &lt;/div&gt;

  &lt;span class=&quot;pagination__count&quot;&gt;Page {{ .PageNumber }} of {{ .TotalPages }}&lt;/span&gt;
&lt;/nav&gt;
{{ end }}
</code></pre></section><footer class=post__footer><ul class=post__tags><li class=post__tag><a href=/tags/hugo class=post__tag-link><span class=post__tag-label>#</span>hugo</a></li></ul></footer></article><aside class=post-siblings><nav class=post-siblings__ctrl><a class="post-siblings__nav post-siblings__nav--next" href=https://til.neilmagee.com/post/material-ui-theming-and-style-overrides-pt4/ rel=nofollow><span class=post-siblings__nav-icon><svg id="Chevron_left" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 20 20" enable-background="new 0 0 20 20"><path d="M12.452 4.516c.446.436.481 1.043.0 1.576L8.705 10l3.747 3.908c.481.533.446 1.141.0 1.574-.445.436-1.197.408-1.615.0-.418-.406-4.502-4.695-4.502-4.695C6.112 10.57 6 10.285 6 10s.112-.57.335-.789c0 0 4.084-4.287 4.502-4.695C11.255 4.107 12.007 4.08 12.452 4.516z" class="post-siblings__nav-icon-next" /></svg></span>Next</a>
<a class="post-siblings__nav post-siblings__nav--previous" href=https://til.neilmagee.com/post/web-fonts-in-email/ rel=nofollow>Previous<span class=post-siblings__nav-icon><svg id="Chevron_right" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 20 20" enable-background="new 0 0 20 20"><path d="M9.163 4.516c.418.408 4.502 4.695 4.502 4.695C13.888 9.43 14 9.715 14 10s-.112.57-.335.787c0 0-4.084 4.289-4.502 4.695-.418.408-1.17.436-1.615.0-.446-.434-.481-1.041.0-1.574L11.295 10 7.548 6.092c-.481-.533-.446-1.141.0-1.576C7.993 4.08 8.745 4.107 9.163 4.516z" class="post-siblings__nav-icon-previous" /></svg></span></a></nav><span class=post-siblings__more>More posts</span></aside></main><footer class=site-footer><div class=site-footer__inner><p class=site-footer__copyright>&copy; 2020&nbsp;<a href=https://neilmagee.com>Neil Magee</a>
. Icons from <a href=http://entypo.com>Entypo+</a>. Made with <a href=https://gohugo.io/ class=site-footer__hugo-logo><img src=/images/hugo-logo.png alt="Hugo logo" width=22 height=22></a></p></div></footer></div></div><script src=/js/highlight.pack.js></script><script>document.addEventListener("DOMContentLoaded",event=>{document.documentElement.classList.remove("no-js");document.querySelectorAll("pre:not(.chroma) code").forEach(block=>{hljs.highlightBlock(block);});});</script></body></html>